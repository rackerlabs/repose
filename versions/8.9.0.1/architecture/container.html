<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>8.9.0.1 | Architecture | Container</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="/_stylesheets/asciibinder.css" >
  <link rel="stylesheet" href="/_stylesheets/repose.css" >

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
   <!--[if lt IE 9]>
     <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
     <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
   <![endif]-->

  <link href="/_images/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="/favicon.ico"><![endif]-->
  <meta content="AsciiBinder" name="application-name">
</head>
<body onload="selectVersion('8.9.0.1');">
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a class="navbar-brand" href="http://www.openrepose.org/">
          <img alt="OpenRepose" src="/_images/repose-logo.png" align="bottom">
        </a>
      </li>
      <li class="sitename">
        <a href="../../index.html">
          Home
        </a>
      </li>
      <li class="hidden-xs active">
        <a href="/versions/8.9.0.1/welcome/index.html">
          Repose
        </a>
        <select id="version-selector" onchange="versionSelector(this);" w3-include-html="/_includes/versions.html">
        </select>
      </li>
      <li class="hidden-xs active">
        <a href="../architecture/index.html">Architecture</a>
      </li>
      
      <li class="hidden-xs active">
        Container
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <a class="navbar-search" href="/versions/search.html">
          <span class="glyphicon glyphicon-search"/>
          Search
        </a>
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-right"></span>Welcome to Repose
      </a>
      <ul id="topicGroup0" class="collapse  list-unstyled">
            <li><a class="" href="../welcome/index.html">Welcome</a></li>
            <li><a class="" href="../welcome/troubleshooting.html">Troubleshooting</a></li>
            <li><a class="" href="../welcome/release-notes.html">Release Notes</a></li>
            <li><a class="" href="../welcome/style-guide.html">Style Guide</a></li>
            <li><a class="" href="../welcome/faq.html">FAQ</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup1">
        <span id="tgSpan1" class="fa fa-angle-down"></span>Architecture
      </a>
      <ul id="topicGroup1" class="collapse in list-unstyled">
            <li><a class="" href="../architecture/index.html">Overview</a></li>
            <li><a class="" href="../architecture/configuration.html">Configuration</a></li>
            <li><a class=" active" href="../architecture/container.html">Container</a></li>
            <li><a class="" href="../architecture/packages.html">Packages</a></li>
            <li><a class="" href="../architecture/system-model.html">System Model</a></li>
            <li><a class="" href="../architecture/performance.html">Performance</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup2">
        <span id="tgSpan2" class="fa fa-angle-right"></span>Recipes
      </a>
      <ul id="topicGroup2" class="collapse  list-unstyled">
            <li><a class="" href="../recipes/index.html">Overview</a></li>
            <li><a class="" href="../recipes/quick-start.html">Quick Start</a></li>
            <li><a class="" href="../recipes/getting-started.html">Getting Started</a></li>
            <li><a class="" href="../recipes/custom-filter-for-repose.html">Custom Filter for Repose</a></li>
            <li><a class="" href="../recipes/docker.html">Docker</a></li>
            <li><a class="" href="../recipes/performance-best-practices.html">Performance Best Practices</a></li>
            <li><a class="" href="../recipes/role-based-access-control.html">Role Based Access Control</a></li>
            <li><a class="" href="../recipes/running-valve.html">Running Valve</a></li>
            <li><a class="" href="../recipes/valve-installation.html">Valve Installation</a></li>
            <li><a class="" href="../recipes/war-installation.html">WAR Installation</a></li>
            <li><a class="" href="../recipes/echo-server.html">Echo Server</a></li>
            <li><a class="" href="../recipes/rate-limiting.html">Rate Limiting</a></li>
            <li><a class="" href="../recipes/multi-tenant.html">Multi Tenant Authorization</a></li>
            <li><a class="" href="../recipes/user-access-events.html">User Access Events</a></li>
            <li><a class="" href="../recipes/basic-authentication.html">Basic Authentication</a></li>
            <li><a class="" href="../recipes/delegation.html">Delegation</a></li>
            <li><a class="" href="../recipes/preventing-xml-bomb.html">Preventing XML bomb attacks</a></li>
            <li><a class="" href="../recipes/api-event-flume.html">API Access Event Recording with Flume</a></li>
            <li><a class="" href="../recipes/xsd-versioning.html">XSD Versioning Guidelines</a></li>
            <li><a class="" href="../recipes/client-authentication.html">SSL/TLS Client Authentication</a></li>
            <li><a class="" href="../recipes/functional-test-framework.html">Functional Test Framework</a></li>
            <li><a class="" href="../recipes/glassfish-setup.html">Glassfish Setup</a></li>
            <li><a class="" href="../recipes/tomcat-setup.html">Tomcat Setup</a></li>
            <li><a class="" href="../recipes/http-container-attributes.html">HTTP Container Attributes</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup3">
        <span id="tgSpan3" class="fa fa-angle-right"></span>Filters
      </a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../filters/index.html">Overview</a></li>
            <li><a class="" href="../filters/add-header.html">Add Header Filter</a></li>
            <li><a class="" href="../filters/api-validator.html">API Validator Filter</a></li>
            <li><a class="" href="../filters/attribute-mapping-policy-validation.html">Attribute Mapping Policy Validation filter</a></li>
            <li><a class="" href="../filters/body-extractor-to-header.html">Body Extractor to Header Filter</a></li>
            <li><a class="" href="../filters/body-patcher.html">Body Patcher Filter</a></li>
            <li><a class="" href="../filters/compression.html">Compression Filter</a></li>
            <li><a class="" href="../filters/content-type-stripper.html">Content Type Stripper Filter</a></li>
            <li><a class="" href="../filters/cors.html">CORS Filter</a></li>
            <li><a class="" href="../filters/derp.html">Delegation Response Processor (DeRP) Filter</a></li>
            <li><a class="" href="../filters/destination-router.html">Destination Router Filter</a></li>
            <li><a class="" href="../filters/echo.html">Echo Filter</a></li>
            <li><a class="" href="../filters/exception.html">Exception Filter</a></li>
            <li><a class="" href="../filters/forwarded-proto.html">Forwarded Protocol Filter</a></li>
            <li><a class="" href="../filters/header-normalization.html">Header Normalization filter</a></li>
            <li><a class="" href="../filters/header-translation.html">Header Translation Filter</a></li>
            <li><a class="" href="../filters/header-user.html">Header User Filter</a></li>
            <li><a class="" href="../filters/herp.html">Highly Efficient Record Processor (HERP) Filter</a></li>
            <li><a class="" href="../filters/ip-user.html">IP User Filter</a></li>
            <li><a class="" href="../filters/iri-validator.html">IRI Validator Filter</a></li>
            <li><a class="" href="../filters/keystone-v2.html">Keystone v2 Filter</a></li>
            <li><a class="" href="../filters/keystone-v2-authorization.html">Keystone v2 Authorization Filter</a></li>
            <li><a class="" href="../filters/keystone-v2-basic-auth.html">Keystone v2 Basic Auth Filter</a></li>
            <li><a class="" href="../filters/merge-header.html">Merge Header Filter</a></li>
            <li><a class="" href="../filters/openstack-identity-v3.html">Openstack Identity v3 Filter</a></li>
            <li><a class="" href="../filters/rackspace-auth-user.html">Rackspace Auth User Filter</a></li>
            <li><a class="" href="../filters/rate-limiting.html">Rate Limiting Filter</a></li>
            <li><a class="" href="../filters/regex-rbac.html">RegEx Role Based Access Control (RBAC) Filter</a></li>
            <li><a class="" href="../filters/saml-policy.html">SAML Policy Translation Filter</a></li>
            <li><a class="" href="../filters/scripting.html">Scripting Filter</a></li>
            <li><a class="" href="../filters/simple-rbac.html">Simple Role Based Access Control (RBAC) Filter</a></li>
            <li><a class="" href="../filters/slf4j-http-logging.html">SFL4J HTTP Logging Filter</a></li>
            <li><a class="" href="../filters/tenant-culling.html">Tenant Culling Filter</a></li>
            <li><a class="" href="../filters/translation.html">Translation Filter</a></li>
            <li><a class="" href="../filters/uri-normalization.html">URI Normalization Filter</a></li>
            <li><a class="" href="../filters/uri-stripper.html">URI Stripper Filter</a></li>
            <li><a class="" href="../filters/uri-user.html">URI User Filter</a></li>
            <li><a class="" href="../filters/url-extractor-to-header.html">URL Extractor to Header Filter</a></li>
            <li><a class="" href="../filters/valkyrie-authorization.html">Valkyrie Authorization Filter</a></li>
            <li><a class="" href="../filters/versioning.html">Versioning Filter</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup4">
        <span id="tgSpan4" class="fa fa-angle-right"></span>Services
      </a>
      <ul id="topicGroup4" class="collapse  list-unstyled">
            <li><a class="" href="../services/index.html">Overview</a></li>
            <li><a class="" href="../services/atom-feed-consumption.html">Atom Feed Consumption Service</a></li>
            <li><a class="" href="../services/datastores.html">Datastores</a></li>
            <li><a class="" href="../services/health-check.html">Health Check service</a></li>
            <li><a class="" href="../services/http-connection-pool.html">HTTP Connection Pool service</a></li>
            <li><a class="" href="../services/logging.html">Logging Service</a></li>
            <li><a class="" href="../services/metrics.html">Metrics Service</a></li>
            <li><a class="" href="../services/open-tracing.html">OpenTracing Service</a></li>
            <li><a class="" href="../services/phone-home.html">Phone Home Service</a></li>
            <li><a class="" href="../services/response-messaging.html">Response Messaging service</a></li>
            <li><a class="" href="../services/uri-redaction.html">URI Redaction service</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup5">
        <span id="tgSpan5" class="fa fa-angle-right"></span>Developer
      </a>
      <ul id="topicGroup5" class="collapse  list-unstyled">
            <li><a class="" href="../developer/index.html">Overview</a></li>
            <li><a class="" href="../developer/docker.html">Docker</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Container</h2>
        </div>
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The container configuration is required to set up <strong>Repose</strong>.
It is used to tell the system where to look for component artifacts and where to deploy them.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following example shows a basic configuration for the Container file.</p>
</div>
<div class="listingblock">
<div class="title">container.cfg.xml - Default</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;repose-container</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">http://docs.openrepose.org/repose/container/v2.0</span><span style="color:#710">'</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;deployment-config&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;deployment-directory</span> <span style="color:#b48">auto-clean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">false</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>/var/repose<span style="color:#070;font-weight:bold">&lt;/deployment-directory&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifact-directory</span> <span style="color:#b48">check-interval</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">60000</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>/usr/share/repose/filters<span style="color:#070;font-weight:bold">&lt;/artifact-directory&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;logging-configuration</span> <span style="color:#b48">href</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file:///etc/repose/log4j2.xml</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/deployment-config&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/repose-container&gt;</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="schema"><a class="anchor" href="#schema"></a><a href="../schemas/container-configuration.xsd">Schema</a></h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="cluster-specific-container-configuration"><a class="anchor" href="#cluster-specific-container-configuration"></a>Cluster Specific Container Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A user may configure different values for different <strong>Repose</strong> clusters.
This is achieved by including one or more <code>cluster-config</code> elements which map to clusters in the system-model.
All configuration within a <code>cluster-config</code> element is optional.
When configuration is present, it will override the base configuration (i.e., the <code>deployment-config</code> element) values.
This functionality may be referred to as <em>"container configuration patching"</em> or simply as <em>"patching"</em>.</p>
</div>
<div class="paragraph">
<p>When discussing patches, one might notice that there is ambiguity in the rules for how patches are applied.
Below is a list of common ambiguities, and how they are handled in this context:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Is there any way to <em>"patch out"</em> or remove some configuration that is in the <code>deployment-config</code> element?</p>
<div class="ulist">
<ul>
<li>
<p>Generally speaking, no.
The applied patch will only override existing values.
There is no way to designate that some configuration should be removed.
However, there is a case where configuration may technically be removed â€“ collections.
See the next bullet for more details.</p>
</li>
</ul>
</div>
</li>
<li>
<p>How are collections (i.e., <em>all</em> and <em>sequence</em> XSD elements, <em>list</em> attributes) patched?
Are elements in the patch collection added to the base collection?
Does the patch collection replace the base collection?</p>
<div class="ulist">
<ul>
<li>
<p>Patching will treat collections as a single unit, and so configuring a collection in the <code>cluster-config</code> (e.g., <code>included-protocols</code> for SSL) will result in that cluster using the <em>"patched"</em> collection.
It will not use anything configured in the <code>deployment-config</code> element.
Items in collections are not combined.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Not all configuration is patchable.
Some values (e.g., the <code>deployment-directory</code>) cannot be overridden due to internal system constraints.
Currently the only items that are patchable are some of the <code>deployment-config</code> element&#8217;s attributes.
Specifically only the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>via</code> (Deprecated scheduled for removal in v9.0.0.0)</p>
</li>
<li>
<p><code>via-header</code></p>
</li>
<li>
<p><code>content-body-read-limit</code></p>
</li>
<li>
<p><code>idleTimeout</code></p>
</li>
<li>
<p><code>soLingerTime</code></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Something else to be aware of is that the <code>deployment-directory</code> and <code>artifact-directory</code> values should be fully qualified paths.
This is the case as the exact location of the launcing JVM may not remain in the same location and this would effect relative paths.
The path should not start or end with a whitespace character as all leading and trailing whitespace is ignored in reading this value.
All white space in the middle of the path name will be preserved and should not be escaped in any way.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="artifacts"><a class="anchor" href="#artifacts"></a>Artifacts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Artifacts are files containing resources which extend the functionality of <strong>Repose</strong>.
Technically, <strong>Repose</strong> artifacts are Enterprise Application Archives (EARs).</p>
</div>
<div class="paragraph">
<p>For example, as part of the package installation of <strong>Repose</strong> (either using a DEB or RPM package), a <code>filter-bundle-x.x.x.x.ear</code> artifact is placed in the default artifact directory.
The filter bundle artifact provides a number of filters that can be used in the filter chain, as well as descriptors of those filters.
Without this artifact, <strong>Repose</strong> would not know about the filters contained within, and therefore, would be not able to use those filters in the filter chain.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deployment"><a class="anchor" href="#deployment"></a>Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The deployment process is the process by which <strong>Repose</strong> organizes the content of <a href="#artifacts">Artifacts</a> in preparation for utilization.</p>
</div>
<div class="paragraph">
<p>To be more specific, the deployment process is comprised of the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identify all artifacts in the <code>artifact-directory</code>.</p>
</li>
<li>
<p>Compute the hash of each artifact.</p>
</li>
<li>
<p>Create a directory for each artifact as a subdirectory of the <code>deployment-directory</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Each artifact will be associated with its own directory.</p>
</li>
<li>
<p>The name of each directory will be the hash of the associated artifact.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Extract the contents of the each artifact to its associated directory.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Since each artifact is extracted to a directory named the hash of said artifact, deployment directory names are consistent and predictable.
As a result, there will be only one copy of the extracted contents of each artifact, and therefore, disk space usage should also be predictable.</p>
</div>
<div class="paragraph">
<p>The <code>auto-clean</code> feature may be used to delete deployment directories when <strong>Repose</strong> shuts down.
This feature helps manage disk space usage, and remove the contents of artifacts which are no longer in use.
Only deployment directories created by the instance of <strong>Repose</strong> which is shutting down will be deleted.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If all of the follow conditions are met, <strong>Repose</strong> may delete deployment directories that are in use by other <strong>Repose</strong> processes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>More than one <strong>Repose</strong> process is running.</p>
</li>
<li>
<p>More than one <strong>Repose</strong> process is using the same deployment directory.</p>
</li>
<li>
<p>At least one <strong>Repose</strong> process has enabled the <code>auto-clean</code> feature.</p>
</li>
<li>
<p>One of the <strong>Repose</strong> processes with the <code>auto-clean</code> feature enabled stops gracefully.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To avoid this situation, it is highly recommended that the same <code>deployment-directory</code> is not used for more than one <strong>Repose</strong> instance.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="via-header-configuration"><a class="anchor" href="#via-header-configuration"></a>Via Header Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following assume:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the request and response are <code>HTTP/1.1</code></p>
</li>
<li>
<p>the host is <code>localhost</code></p>
</li>
<li>
<p>the servicing port is <code>10010</code></p>
</li>
<li>
<p>the <strong>Repose</strong> version is <code>8.4.1.0</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The interaction between the deprecated <code>via</code> attribute and the new <code>via-header</code> element are as follows:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">via attribute</th>
<th class="tableblock halign-left valign-top">via-header element</th>
<th class="tableblock halign-left valign-top">Request header</th>
<th class="tableblock halign-left valign-top">Response header</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 localhost:10010 (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Repose (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Stuff</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Stuff (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Stuff (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Stuff</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Defined</strong></p></td>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Will not parse</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following further assumes the deprecated <code>via</code> attribute is not defined and the <code>via-header</code> element contains:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">request-prefix</th>
<th class="tableblock halign-left valign-top">response-prefix</th>
<th class="tableblock halign-left valign-top">repose-version</th>
<th class="tableblock halign-left valign-top">Request header</th>
<th class="tableblock halign-left valign-top">Response header</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 localhost:10010 (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Repose (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Potato</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Potato (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Repose (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Salad</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 localhost:10010 (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Salad (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Potato</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Salad</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Potato (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Salad (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 localhost:10010 (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Repose (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Potato</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Potato (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Repose (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Salad</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 localhost:10010 (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Salad (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Potato</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Salad</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Potato (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Salad (Repose/8.4.1.0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 localhost:10010 (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No header <strong>added</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Potato</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Potato (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No header <strong>added</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undefined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Salad</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 localhost:10010 (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Salad</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Potato</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Salad</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Potato (Repose/8.4.1.0)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1 Salad</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="user-supplied-logging-configuration"><a class="anchor" href="#user-supplied-logging-configuration"></a>User-Supplied Logging Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are two steps to supply a logging configuration for <strong>Repose</strong>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a log configuration file to the <strong>Repose</strong> configuration files directory (e.g., <code>/etc/repose</code>).</p>
</li>
<li>
<p>Specify the name of the log configuration file in the <code>container.cfg.xml</code> file.
It should look like the following example.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">container.cfg.xml - Logging</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;logging-configuration</span> <span style="color:#b48">href</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file:///etc/repose/log4j2.xml</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="default-logging-configuration"><a class="anchor" href="#default-logging-configuration"></a>Default Logging Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a user-supplied logging configuration file is not found, <strong>Repose</strong> programmatically sets default log4j properties.
This default properties add a
<a href="https://logging.apache.org/log4j/2.x/manual/appenders.html#ConsoleAppender">ConsoleAppender</a>
to the ROOT logger.
The output will be formatted using a
<a href="https://logging.apache.org/log4j/2.x/manual/layouts.html#PatternLayout">PatternLayout</a>
set to the pattern <code>%d %-4r [%t] %-5p %c - %m%n</code>.
The default log level is set to DEBUG.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ssltls-client-authentication"><a class="anchor" href="#ssltls-client-authentication"></a>SSL/TLS Client Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SSL/TLS Client Authentication is being used more and more for communications between different enclaves.
This addition to the SSL/TLS handshake involves the Client presenting credentials to the Server in the same manner as the Server does to the Client.
If the credentials presented by the Client are not trusted, then the Server will sever the connection just as the Client would have if the situation was reversed.
Since a Client initiates contact with the Server, the Server&#8217;s credentials are simply to validate it is who the Client was trying to contact.
This is accomplished through Certificate Authorities (CA) and the Trust Hierarchies built into the Public Key Infrastructure (PKI).
Even though you can optionally add a particular Server&#8217;s credentials directly into a Client so that it will implicitly trust a particular Server essentially bypassing the distributed trust mechanism in favor of a more direct one, this is the only way to build a relationship for a Client to a Server.</p>
</div>
<div class="paragraph">
<p>To require SSL/TLS Client Authentication, set the <code>need-client-auth</code> attribute to <em>True</em>.
With this setting enabled, only Clients that have a Public Key imported into the trust store referenced by the <code>truststore-filename</code> element will be allowed to connect.
The truststore is a
<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#KeystoreImplementation">Java Keystore</a>
that can be created/updated using the command line tool named aptly enough,
<a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html">keytool</a>.
Below is an example of importing a Client certificate (<code>client.crt</code>) into a truststore (<code>truststore.jks</code>):</p>
</div>
<div class="listingblock">
<div class="title">keytool</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">keytool -import -file client.crt -alias client -keystore truststore.jks</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This will update the keystore if it exists or create a new one if it doesn&#8217;t.
The tool will also prompt for a password.
The password will be used to access an existing file or set as the password on a new one.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To use the truststore created/updated in the example above, the following would need to be added/updated in the container.cfg.xml file:</p>
</div>
<div class="listingblock">
<div class="title">container.cfg.xml - Truststore</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;ssl-configuration</span> <span style="color:#b48">need-client-auth</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;truststore-filename&gt;</span>truststore.jks<span style="color:#070;font-weight:bold">&lt;/truststore-filename&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;truststore-password&gt;</span>password<span style="color:#070;font-weight:bold">&lt;/truststore-password&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.eclipse.org/jetty/documentation/current/configuring-ssl.html#loading-keys-and-certificates" class="bare">http://www.eclipse.org/jetty/documentation/current/configuring-ssl.html#loading-keys-and-certificates</a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html" class="bare">https://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html</a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#KeystoreImplementation" class="bare">https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#KeystoreImplementation</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="valve-configuration-of-ssltls-certificates"><a class="anchor" href="#valve-configuration-of-ssltls-certificates"></a>Valve Configuration of SSL/TLS Certificates</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Repose Valve</strong> is based on Jetty and uses its services for SSL/TLS termination.
To enable this feature you need to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Obtain keys and certificates from somewhere OR <a href="http://www.eclipse.org/jetty/documentation/current/configuring-ssl.html">generate them</a>.</p>
</li>
<li>
<p><a href="http://www.eclipse.org/jetty/documentation/current/configuring-ssl.html#loading-keys-and-certificates">Load the keys and certificates into a keystore file</a>.</p>
</li>
<li>
<p>Place the keystore file in your <strong>Repose</strong> configuration root directory.</p>
</li>
<li>
<p>Place the keystore information in your <code>container.cfg.xml</code> file.</p>
</li>
<li>
<p>Place the desired HTTPS port in your <code>system-model.cfg.xml</code> file.
See <a href="system-model.html">System Model</a> for more details.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Keystore information is located within the <code>&lt;ssl-configuration&gt;</code> element as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="title">container.cfg.xml - SSL/TLS Certificates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;repose-container</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">http://docs.openrepose.org/repose/container/v2.0</span><span style="color:#710">'</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;deployment-config&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;deployment-directory</span> <span style="color:#b48">auto-clean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">false</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>/var/repose<span style="color:#070;font-weight:bold">&lt;/deployment-directory&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifact-directory</span> <span style="color:#b48">check-interval</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">60000</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>/usr/share/repose/filters<span style="color:#070;font-weight:bold">&lt;/artifact-directory&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;logging-configuration</span> <span style="color:#b48">href</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">log4j2.xml</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;ssl-configuration&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;keystore-filename&gt;</span>keystore.repose<span style="color:#070;font-weight:bold">&lt;/keystore-filename&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;keystore-password&gt;</span>manage<span style="color:#070;font-weight:bold">&lt;/keystore-password&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;key-password&gt;</span>password<span style="color:#070;font-weight:bold">&lt;/key-password&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/ssl-configuration&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/deployment-config&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/repose-container&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="whitelisting-and-blacklisting-ciphers-and-protocols"><a class="anchor" href="#whitelisting-and-blacklisting-ciphers-and-protocols"></a>Whitelisting and Blacklisting Ciphers and Protocols</h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since security is a constantly moving target, any recommended configuration would quickly become out of date.
A risk assessment should always be performed by the appropriately qualified people for your organization.
Links to industry-standard references are provided in the SSL References section below.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Repose</strong> supports whitelisting and blacklisting specific protocols and ciphers by exposing portions of the Jetty configuration via the <code>container.cfg.xml</code> file.
You can use this feature if a specific protocol or cipher has been compromised and you want to block its usage and harden your <strong>Repose</strong> instance.
Any of Jetty&#8217;s built-in defaults are cleared and then the configured inclusion and exclusion lists are applied if any are defined.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>When working with Includes / Excludes, it is important to know that Excludes will always win.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Jetty<br>
<cite>The Definitive Reference</cite>
</div>
</div>
<div class="paragraph">
<p>In the following example, the container configuration includes the TLS v1.2 protocol and TLS ciphers and excludes then SSLv3 protocol and SSL ciphers.</p>
</div>
<div class="listingblock">
<div class="title">container.cfg.xml - Protocols and ciphers</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;repose-container</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">http://docs.openrepose.org/repose/container/v2.0</span><span style="color:#710">'</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;deployment-config&gt;</span>
       <span style="color:#070;font-weight:bold">&lt;deployment-directory</span> <span style="color:#b48">auto-clean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">false</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>/var/repose<span style="color:#070;font-weight:bold">&lt;/deployment-directory&gt;</span>
       <span style="color:#070;font-weight:bold">&lt;artifact-directory</span> <span style="color:#b48">check-interval</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">60000</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>/usr/share/repose/filters<span style="color:#070;font-weight:bold">&lt;/artifact-directory&gt;</span>
       <span style="color:#070;font-weight:bold">&lt;logging-configuration</span> <span style="color:#b48">href</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file:///etc/repose/log4j2.xml</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
       <span style="color:#070;font-weight:bold">&lt;ssl-configuration&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;keystore-filename&gt;</span>keystore.jks<span style="color:#070;font-weight:bold">&lt;/keystore-filename&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;keystore-password&gt;</span>password<span style="color:#070;font-weight:bold">&lt;/keystore-password&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;key-password&gt;</span>password<span style="color:#070;font-weight:bold">&lt;/key-password&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;included-ciphers&gt;</span>
              <span style="color:#070;font-weight:bold">&lt;cipher&gt;</span>.*TLS.*<span style="color:#070;font-weight:bold">&lt;/cipher&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;/included-ciphers&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;excluded-ciphers&gt;</span>
              <span style="color:#070;font-weight:bold">&lt;cipher&gt;</span>.*SSL.*<span style="color:#070;font-weight:bold">&lt;/cipher&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;/excluded-ciphers&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;excluded-protocols&gt;</span>
               <span style="color:#070;font-weight:bold">&lt;protocol&gt;</span>SSLv3<span style="color:#070;font-weight:bold">&lt;/protocol&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;/excluded-protocols&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;included-protocols&gt;</span>
              <span style="color:#070;font-weight:bold">&lt;protocol&gt;</span>TLSv1.2<span style="color:#070;font-weight:bold">&lt;/protocol&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;/included-protocols&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;tls-renegotiation-allowed&gt;</span>false<span style="color:#070;font-weight:bold">&lt;/tls-renegotiation-allowed&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/ssl-configuration&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/deployment-config&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/repose-container&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You need to specify your keystore in the container configuration just as you would in Jetty.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="diffie-hellman-security-risk-and-key-size"><a class="anchor" href="#diffie-hellman-security-risk-and-key-size"></a>Diffie-Hellman Security Risk and Key Size</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Certain attacks (such as Logjam) leverage the weakness of "small" Diffie-Hellman (DH) keys.
To mitigate the risk of such attackers, users may either exclude vulnerable ciphers, or lengthen the DH keys used by <strong>Repose</strong>.
Instructions for the former are above.
For the latter, note the following:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Diffie-Hellman (DH) keys of sizes less than 1024 bits have been deprecated because of their insufficient strength.
In JDK 8, you can customize the ephemeral DH key size with the system property jdk.tls.ephemeralDHKeySize.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Java Secure Socket Extension (JSSE) Reference Guide
</div>
</div>
<div class="paragraph">
<p>In other words, the Java option <code>-Djdk.tls.ephemeralDHKeySize=2048</code> can be passed when starting <strong>Repose</strong> to force the use of longer DH keys.</p>
</div>
<div class="paragraph">
<p>For more details, see <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#customizing_dh_keys">Customizing DH Keys</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ssltls-references"><a class="anchor" href="#ssltls-references"></a>SSL/TLS References</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For more information about cipher suites and which ones to dis/allow when setting up <strong>Repose</strong>, see the following references:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://security.stackexchange.com/questions/76993/now-that-it-is-2015-what-ssl-tls-cipher-suites-should-be-used-in-a-high-securit" class="bare">http://security.stackexchange.com/questions/76993/now-that-it-is-2015-what-ssl-tls-cipher-suites-should-be-used-in-a-high-securit</a></p>
</li>
<li>
<p><a href="https://www.ssllabs.com/" class="bare">https://www.ssllabs.com/</a></p>
</li>
<li>
<p><a href="https://wiki.eclipse.org/Jetty/Howto/CipherSuites#Enabling_Cipher_Suites" class="bare">https://wiki.eclipse.org/Jetty/Howto/CipherSuites#Enabling_Cipher_Suites</a></p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet" class="bare">https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet</a></p>
</li>
<li>
<p><a href="https://cipherli.st/" class="bare">https://cipherli.st/</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="available-ciphers-and-protocols"><a class="anchor" href="#available-ciphers-and-protocols"></a>Available Ciphers and Protocols</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The list of available ciphers and protocols varies depending on the JVM.
We have added a command line option to <strong>Repose Valve</strong> to display the available and default enabled ciphers and protocols:</p>
</div>
<div class="listingblock">
<div class="title">Show SSL Params</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -jar /usr/share/repose/repose-valve.jar --show-ssl-params</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will dump a list of the default enabled SSL/TLS parameters for the JVM you&#8217;re using.
Additionally, it will list all available ciphers and protocols, should you wish to use one of those.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-in-insecure-mode"><a class="anchor" href="#running-in-insecure-mode"></a>Running in Insecure Mode</h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This mode should only be used during development testing.
These settings are NOT intended for a production environment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When running in insecure mode, <strong>Repose</strong> will accept all certificates from external services with which it communicates (e.g., authentication service, origin service).</p>
</div>
<div class="sect2">
<h3 id="valve"><a class="anchor" href="#valve"></a>Valve</h3>
<div class="paragraph">
<p>When running the Valve deployment, <strong>Repose</strong> may be placed in insecure mode by passing in the <code>-k</code> option as follows:</p>
</div>
<div class="listingblock">
<div class="title">Insecure Mode - Valve</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -jar /usr/share/repose/repose-valve.jar -c /etc/repose -k</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="root-war"><a class="anchor" href="#root-war"></a>ROOT.war</h3>
<div class="paragraph">
<p>When running the ROOT.war deployment, <strong>Repose</strong> may be placed in insecure mode by passing in the following system property:</p>
</div>
<div class="listingblock">
<div class="title">Insecure Mode - ROOT.war</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">-Dinsecure=true</code></pre>
</div>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script src="/_javascripts/page-loader.js" type="text/javascript"></script>
  <script src="/_javascripts/include-html.js" type="text/javascript"></script>
  <script>includeHTML();</script>
  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
</body>
</html>