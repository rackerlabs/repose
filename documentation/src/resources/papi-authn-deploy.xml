<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book [
    <!-- Some useful entities borrowed from HTML -->
    <!ENTITY ndash  "&#x2013;">
    <!ENTITY mdash  "&#x2014;">
    <!ENTITY hellip "&#x2026;">

    <!-- Useful for describing APIs -->
    <!ENTITY GET    '<command xmlns="http://docbook.org/ns/docbook">GET</command>'>
    <!ENTITY PUT    '<command xmlns="http://docbook.org/ns/docbook">PUT</command>'>
    <!ENTITY POST   '<command xmlns="http://docbook.org/ns/docbook">POST</command>'>
    <!ENTITY DELETE '<command xmlns="http://docbook.org/ns/docbook">DELETE</command>'>

    <!ENTITY CHECK  '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
        <imageobject>
        <imagedata fileref="img/Check_mark_23x20_02.svg"
        format="SVG" scale="60"/>
        </imageobject>
        </inlinemediaobject>'>

    <!ENTITY ARROW  '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
        <imageobject>
        <imagedata fileref="img/Arrow_east.svg"
        format="SVG" scale="60"/>
        </imageobject>
        </inlinemediaobject>'>
]>
<book version="5.0" status="draft" xmlns="http://docbook.org/ns/docbook"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:svg="http://www.w3.org/2000/svg"
      xmlns:m="http://www.w3.org/1998/Math/MathML"
      xmlns:html="http://www.w3.org/1999/xhtml"
      xmlns:db="http://docbook.org/ns/docbook" >
    <?rax pdf.url="../../papi-authn-deploy.pdf"?>
    <title>Power API Authentication Component Deployment Handbook</title>
    <?rax status.bar.text="CONFIDENTIAL"?>
    <?rax title.font.size="35px" subtitle.font.size="16px"?>
    <titleabbrev>PAPI Authentication Deployment</titleabbrev>
    <info>
        <author>
            <personname>
                <firstname/>
                <surname/>
            </personname>
            <affiliation>
                <orgname>Rackspace Cloud</orgname>
            </affiliation>
        </author>
        <copyright>
            <year>2010</year>
            <year>2011</year>
            <holder>Rackspace US, Inc.</holder>
        </copyright>
        <releaseinfo>API v0.9</releaseinfo>
        <productname>Power API</productname>
        <pubdate>2011-08-19</pubdate>
        <legalnotice role="rs-api">
            <annotation>
                <remark>Copyright details are filled in by the template.</remark>
            </annotation>
        </legalnotice>
        <abstract>
            <para>This document is intended for systems administrators interested in configuring
                their service to use the Client Authenticaion component of the Rackspace Cloud Power
                Application Program Interface (<abbrev>API</abbrev>). </para>
        </abstract>
    </info>
    <chapter xml:id="Overview-d1e85">
        <title>Overview</title>
        <section xml:id="Purpose-d1e90">
            <title>Purpose</title>
            <para> The purpose of this handbook is to facilitate deployment of Power API's client
                authentication component. This handbook is not a tutorial. It provides basic
                information that will help you understand and deploy this Power API component, but
                you must adapt this information to suit your own configuration. </para>
            <para> The client authentication service filter enables the origin service to
                communicate with the authentication service implemented in its environment. It
                accomplishes this by delegating authentication requests to the authentication
                service and returning the results of those requests to the origin service.</para>
            <para>
                This handbook is focused on one Power API component.
                Other Power API components are documented in companion handbooks.
            </para>
        </section>
        <section xml:id="Document_Change_History-d1e102">
            <title>Document Change History</title>
            <para>This version of the guide replaces and obsoletes all previous versions.
                The most recent changes are described in the table below: </para>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td colspan="1">Revision Date</td>
                        <td colspan="4">Summary of Changes</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1" align="center">Aug 8, 2011</td>
                        <td colspan="4" align="left">
                            <itemizedlist spacing="compact">
                                <listitem>
                                    <para>Initial release.</para>
                                </listitem>
                            </itemizedlist>
                        </td>
                    </tr>
                </tbody>
            </informaltable>
        </section>
        <xi:include href="chapters/available-doc.xml"/>
    </chapter>
    <chapter xml:id="Configuration-d1e365">
        <title>Configuration</title>
        <para> 
            Client Authentication is divided into interchangable modules which represent different authentication schemes. 
            Depending on the Power API components being deployed, the authentication configuration may change. 
            In the following example, we are configuring the <code>client-auth</code> component to interact with the Rackspace Cloud Authentication Service. 
        </para>
        <example>
            <title>Client Authentication Configuration: XML</title>
            <programlistingco>
                <areaspec>
                    <area xml:id="papi-authn.xml.delegateable" units="linecolumn" coords="7 21"/>
                    <area xml:id="papi-authn.xml.server" units="linecolumn" coords="10 10"/>
                    <area xml:id="papi-authn.xml.uri" units="linecolumn" coords="11 13"/>
                    <area xml:id="papi-authn.xml.auth" units="linecolumn" coords="11 51"/>
                    <area xml:id="papi-authn.xml.regex" units="linecolumn" coords="13 29"/>
                    <area xml:id="papi-authn.xml.type" units="linecolumn" coords="13 56"/>
                </areaspec> 
                <programlisting language="xml">
<xi:include href="samples/papi-authn.xml" parse="text"/>
                </programlisting>
            </programlistingco>     
        </example>
        <para>
            Key elements of the example are labeled with callouts and explained below:
        </para>
        <calloutlist>
            <callout arearefs="papi-authn.xml.delegateable">
                <para> All Power API authentication modules support authentication
                        <firstterm>delegation</firstterm>. Delegation may be enabled or disabled by
                    setting the <code>rackspace-auth delegatable</code> attribute to <code>true</code> or <code>false</code>. To better
                    protect services, delegation always defaults to <code>false</code>. 
                </para>
                <para>
                    For more about delegation, please refer to the "Authentication in OpenStack" blueprint at 
                    <link xlink:href="http://wiki.openstack.org/openstack-authn">http://wiki.openstack.org/openstack-authn</link>.
                </para>
                <para> </para>
            </callout>
            <callout arearefs="papi-authn.xml.server">
                <para>
                    The <firstterm><code>authentication-server</code></firstterm> configuration element identifies an authentication endpoint.
                    Tokens are validated agains this endpoint.  
                    While a password is required in the configuration file, it is important to note that file permissions can be set to make the configuration file 
                    user-readable only and therefore marginally more secure.
                </para>
                <para> </para>
            </callout>
            <callout arearefs="papi-authn.xml.uri">
                <para> 
                    The <firstterm><code>URI</code></firstterm> attribute of the <code>authentication-server</code> configuration element 
                    identifies a destination to which the component must route token validation requests. 
                    This URI must include all information required to construct an HTTP request, 
                    including the port number the authentication service is listening on and the authentication service's context root.
                </para>
                <para> </para>
            </callout>
            <callout arearefs="papi-authn.xml.auth">
                <para> 
                    The authentication service's context root is <firstterm>/auth</firstterm> in this example.
                </para>
                <para> </para>
            </callout>
            <callout arearefs="papi-authn.xml.regex">
                <para> 
                    Account mappings in the configuration inform the component of where in client-requested URIs to source the client's identity string from. 
                    This is achieved via a regular expression (<firstterm>regex</firstterm>). 
                    In this regular expression, the service implementor is must specify a regular expression capture group which, 
                    when executed, will capture the requesting client's identity string. 
                    This string will then be sent to the authentication service. 
                </para>
                <para> </para>
            </callout>
            <callout arearefs="papi-authn.xml.type">
                <para> 
                    The <firstterm><code>type</code></firstterm> attribute identifies the type of account associated with this authentication request.
                    In this example, the account is of type <code>CLOUD</code>. Valid account types vary depending on the requirements of the authentication service.
                </para>
                <para> </para>
            </callout>
        </calloutlist>
    </chapter>
    <chapter xml:id="Limited-d1e731">
        <title>Authentication Lifecycle</title>
        <para> 
            Power API's authentication lifecycle is directly derived from the "Authentication in OpenStack" blueprint at 
            <link xlink:href="http://wiki.openstack.org/openstack-authn">
            http://wiki.openstack.org/openstack-authn</link>, which defines a standard for authentication. 
            Compliance with this standard enables services to support multiple authentication protocols in a pluggable manner. 
            For further information about Power API's handling of authentication requests, please refer to this blueprint.
        </para> 
    </chapter>
    <xi:include href="chapters/afterword.xml"/>
</book>