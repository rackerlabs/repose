<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>org.openrepose</groupId>
        <artifactId>filters-support</artifactId>
        <version>8.0.0.0-SNAPSHOT</version>
    </parent>

    <name>Repose Components - Header Normalization</name>
    <artifactId>header-normalization-filter</artifactId>
    <packaging>jar</packaging>

    <description>
        The HeaderNormalizationFilter uses black-listing and white-listing to prevent and allow (respectively)
        certain headers
        to pass through to the origin service. These headers are matched by URI regular expressions or HTTP method type.

        Whenever a configuration is updated, every target's blacklist and whitelist are read. Each list is added to a
        list of lists, alongside a regex, http method, and a boolean indicating whether it is a blacklist or whitelist.

        When handleRequest is called, it iterates over each list, and gets all headers to remove from that target.
        (Checks if the headers are blacklist)

        It combines all of these headers to remove into a new list of all headers to remove,
        which lives in FilterDirector.requestHeaderManager().headersToRemove().

        The Header Normalization filter should be placed near the top of the filter chain.
    </description>

    <properties>
        <sonar.jacoco.itReportPath>${project.basedir}/../../../target/jacoco-it.exec</sonar.jacoco.itReportPath>
    </properties>

    <dependencies>
        <!-- FilterConfigHelper -->
        <dependency>
            <groupId>org.openrepose</groupId>
            <artifactId>core-lib</artifactId>
        </dependency>

        <!-- servlet filter stuff -->
        <dependency>
            <groupId>org.openrepose</groupId>
            <artifactId>core-service-api</artifactId>
        </dependency>

        <dependency>
            <groupId>org.jvnet.jaxb2_commons</groupId>
            <artifactId>jaxb2-basics-runtime</artifactId>
        </dependency>

        <!-- HTTP request/response wrappers -->
        <dependency>
            <groupId>org.openrepose</groupId>
            <artifactId>commons-utilities</artifactId>
        </dependency>

        <!-- Let's use Scala -->
        <dependency>
            <groupId>org.scala-lang</groupId>
            <artifactId>scala-library</artifactId>
        </dependency>

        <!-- Scalatest for testing scala -->
        <dependency>
            <groupId>org.scalatest</groupId>
            <artifactId>scalatest_${scala.MajDotMin}</artifactId>
        </dependency>

        <!-- Lazy logging -->
        <dependency>
            <groupId>com.typesafe.scala-logging</groupId>
            <artifactId>scala-logging-slf4j_${scala.MajDotMin}</artifactId>
        </dependency>

        <!-- MockHttpServletRequest/Response -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <scope>test</scope>
        </dependency>

        <!-- LogFactory, needed by MockHttpServletRequest/Response -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.jvnet.jaxb2.maven2</groupId>
                <artifactId>maven-jaxb2-plugin</artifactId>

                <configuration>

                    <specVersion>2.1</specVersion>

                    <schemaIncludes>
                        <include>**/*.xsd</include>
                    </schemaIncludes>
                    <bindingIncludes>
                        <include>**/*.xjb</include>
                    </bindingIncludes>

                    <strict>true</strict>
                    <verbose>false</verbose>

                </configuration>
            </plugin>

        </plugins>
    </build>


</project>
