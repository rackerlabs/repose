<?xml version="1.0" encoding="UTF-8"?>

<power-proxy xmlns="http://docs.rackspacecloud.com/power-api/system-model/v2.0">
  <service-domain id="repose1">
    <service-domain-nodes>
      <node id="proxy-n01" hostname="<%= node[:fqdn]%>" http-port="8887"/>
    </service-domain-nodes>
    <filters>
        <filter name="dist-datastore" />
        <filter name="versioning" />
        <filter name="client-auth" />
        <filter name="uri-normalization" />
        <filter name="header-normalization"/>
    </filters>
    <destinations>
      <endpoint id="service1" protocol="http" hostname="50.57.189.15" root-path="/v1" port="8080" default="true"/>
      <endpoint id="service2" protocol="http" hostname="50.57.189.15" root-path="/v2" port="8080" default="true"/>
      <endpoint id="service3" protocol="http" hostname="50.57.189.15" root-path="/" port="8080" default="true"/>
    </destinations>
  </service-domain>

  <service-domain id="repose2">
    <service-domain-nodes>
      <node id="proxy-n02" hostname="<%= node[:fqdn]%>" http-port="8888"/>
    </service-domain-nodes>
    <filters>
        <filter name="dist-datastore" />
        <filter name="versioning" />
        <filter name="client-auth" />
        <filter name="client-authorization" />
        <filter name="uri-normalization" />
        <filter name="header-normalization"/>
    </filters>
    <destinations>
      <endpoint id="service1" protocol="http" hostname="50.57.189.15" root-path="/v1" port="8080" default="true"/>
      <endpoint id="service2" protocol="http" hostname="50.57.189.15" root-path="/v2" port="8080" default="true"/>
      <endpoint id="service3" protocol="http" hostname="50.57.189.15" root-path="/" port="8080" default="true"/>
    </destinations>
  </service-domain>
</power-proxy>
